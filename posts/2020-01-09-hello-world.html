<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width,initial-scale=1">
    <title>Hello, World!</title>
    <base href="/">
    <link rel="icon" type="image/png" href="assets/favicon.png">
    <link rel="stylesheet" href="assets/dracula.css">
    <link rel="stylesheet" href="assets/style.css">
    <script type="text/javascript" src="assets/highlight.min.js"></script>
    <script type="text/javascript" src="assets/script.js" async defer></script>
  </head>
  <body>
    <div id="container">
      <nav>
  <a href="">Home</a>
    <span class="breadcrumb">></span>
    <a href="posts/">Posts</a>
    <span class="breadcrumb">></span>
    <a href="posts/2020-01-09-hello-world.html">Jan 09, 2020</a>
</nav>
<section>
  <h1>Hello, World!</h1>
<pre><code class="language-haskell">-- Unsafe.hs

import Data.IORef (IORef, newIORef, readIORef, writeIORef)
import System.IO.Unsafe (unsafePerformIO)

var :: a -&gt; IORef a
var = unsafePerformIO . newIORef

(&lt;==) :: IORef a -&gt; a -&gt; ()
r &lt;== a = unsafePerformIO $ writeIORef r a

star :: IORef a -&gt; a
star = unsafePerformIO . readIORef
</code></pre>
<p>Haskell, a <em>purely</em> functional programming language, supports global mutable variables. Load the above script with <code>ghci</code> to see how it works.</p>
<pre><code class="language-plaintext">*Main&gt; let helloWorld = var &quot;Hello, World!&quot;
*Main&gt; star helloWorld
&quot;Hello, World!&quot;
*Main&gt; helloWorld &lt;== &quot;Surprise!&quot;
()
*Main&gt; star helloWorld
&quot;Surprise!&quot;
</code></pre>
<p>Notice, in line <code>1</code>, <code>let</code> is used instead of <code>&lt;-</code>. That's because <code>var</code> is not a monadic action. <code>unsafePerformIO</code> has removed the <code>IO</code> context and made it a &quot;pure&quot; function. <code>unsafePerformIO</code> is also used to achieve false purity in the definitions of the assignment operator <code>&lt;==</code> and the dereference function <code>star</code>. These impurely pure functions can be buried anywhere in a codebase, turning the application into a game of minesweeper.</p>
<p>The <code>unsafePerformIO</code> <a href="https://hackage.haskell.org/package/base-4.12.0.0/docs/System-IO-Unsafe.html#v:unsafePerformIO">documentation</a> provides one of the more humorous lines technical writing has to offer:</p>
<blockquote>
<p>This is the &quot;back door&quot; into the IO monad</p>
</blockquote>

</section>
<script src="https://utteranc.es/client.js"
        repo="wilfreddenton/unsafe-perform.io"
        issue-term="title"
        label="ðŸ”® utterances"
        theme="preferred-color-scheme"
        crossorigin="anonymous"
        async>
</script>
      <footer>
        <p>generated by <a href="https://github.com/wilfreddenton/patina">patina</a></p>
      </footer>
    </div>
  </body>
</html>
